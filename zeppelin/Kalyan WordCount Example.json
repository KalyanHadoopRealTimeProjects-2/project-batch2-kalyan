{"paragraphs":[{"text":"%md\n\n# Kalyan WordCount Spark Example using Zeppelin","dateUpdated":"2017-10-21T18:15:16+0530","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1508585816566_-953086898","id":"20161117-142101_946980807","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Kalyan WordCount Spark Example using Zeppelin</h1>\n"},"dateCreated":"2017-10-21T05:06:56+0530","dateStarted":"2017-10-21T18:15:17+0530","dateFinished":"2017-10-21T18:15:17+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"text":"val file = sc.textFile(\"file:///home/orienit/kalyan/demoinput\")\n\nval words = file.flatMap(_.split(\" \")).map((_,1))\n\nval counts = words.reduceByKey(_+_)\n\ncase class WordCount( word : String, count : Int)\n\nval res1 =  counts.map(x => WordCount(x._1, x._2)).toDF()\n\nres1.registerTempTable(\"tbl1\")\n\n\nval res2 =  words.map(x => WordCount(x._1, x._2)).toDF()\n\nres2.registerTempTable(\"tbl2\")","dateUpdated":"2017-10-21T18:15:17+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1508585816566_-953086898","id":"20161117-142116_1269924135","result":{"code":"SUCCESS","type":"TEXT","msg":"\nfile: org.apache.spark.rdd.RDD[String] = file:///home/orienit/kalyan/demoinput MapPartitionsRDD[1] at textFile at <console>:29\n\nwords: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[3] at map at <console>:31\n\ncounts: org.apache.spark.rdd.RDD[(String, Int)] = ShuffledRDD[4] at reduceByKey at <console>:33\n\ndefined class WordCount\n\nres1: org.apache.spark.sql.DataFrame = [word: string, count: int]\n\nres2: org.apache.spark.sql.DataFrame = [word: string, count: int]\n"},"dateCreated":"2017-10-21T05:06:56+0530","dateStarted":"2017-10-21T18:15:17+0530","dateFinished":"2017-10-21T18:15:53+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"%sql \n\nselect word, count from tbl1","dateUpdated":"2017-10-21T18:15:17+0530","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1508585816567_-953471647","id":"20161117-142328_1337539294","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nlearning\t1\nhadoop\t1\nam\t2\ni\t2\nhyd\t1\nto\t1\ngoing\t1\ncourse\t1\n","comment":"","msgTable":[[{"key":"count","value":"learning"},{"key":"count","value":"1"}],[{"value":"hadoop"},{"value":"1"}],[{"value":"am"},{"value":"2"}],[{"value":"i"},{"value":"2"}],[{"value":"hyd"},{"value":"1"}],[{"value":"to"},{"value":"1"}],[{"value":"going"},{"value":"1"}],[{"value":"course"},{"value":"1"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["learning","1"],["hadoop","1"],["am","2"],["i","2"],["hyd","1"],["to","1"],["going","1"],["course","1"]]},"dateCreated":"2017-10-21T05:06:56+0530","dateStarted":"2017-10-21T18:15:18+0530","dateFinished":"2017-10-21T18:17:05+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"text":"%sql \n\nselect word, count from tbl2","dateUpdated":"2017-10-21T18:15:18+0530","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1508585816567_-953471647","id":"20161117-142350_950957992","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\ni\t1\nam\t1\ngoing\t1\nto\t1\nhyd\t1\ni\t1\nam\t1\nlearning\t1\nhadoop\t1\ncourse\t1\n","comment":"","msgTable":[[{"key":"count","value":"i"},{"key":"count","value":"1"}],[{"value":"am"},{"value":"1"}],[{"value":"going"},{"value":"1"}],[{"value":"to"},{"value":"1"}],[{"value":"hyd"},{"value":"1"}],[{"value":"i"},{"value":"1"}],[{"value":"am"},{"value":"1"}],[{"value":"learning"},{"value":"1"}],[{"value":"hadoop"},{"value":"1"}],[{"value":"course"},{"value":"1"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["i","1"],["am","1"],["going","1"],["to","1"],["hyd","1"],["i","1"],["am","1"],["learning","1"],["hadoop","1"],["course","1"]]},"dateCreated":"2017-10-21T05:06:56+0530","dateStarted":"2017-10-21T18:15:54+0530","dateFinished":"2017-10-21T18:17:08+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"","dateUpdated":"2017-10-21T18:15:24+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1508585816567_-953471647","id":"20161117-142356_1808158616","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-10-21T05:06:56+0530","dateStarted":"2017-10-21T18:17:08+0530","dateFinished":"2017-10-21T18:17:08+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83"}],"name":"Kalyan WordCount Example","id":"2CWJEAY83","angularObjects":{"2CW38YBRP:shared_process":[],"2CY7CNTM4:shared_process":[],"2CWHSPVHC:shared_process":[],"2CW9TVMFV:shared_process":[],"2CXMZENH3:shared_process":[],"2CVQB9C6U:shared_process":[],"2CY7QF7DD:shared_process":[],"2CXX7Q9D2:shared_process":[],"2CXS9BB4T:shared_process":[],"2CXYDKBJK:shared_process":[],"2CV6S62K4:shared_process":[],"2CX7RCRK1:shared_process":[],"2CYKRNKDY:shared_process":[],"2CW1E1SKN:shared_process":[],"2CYZ1GXK3:shared_process":[],"2CWJ733K6:shared_process":[],"2CW18UXYG:shared_process":[],"2CYH5TBKT:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}